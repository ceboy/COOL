// MESHES

int mywait = 1;
string myname = "geo4";

real L = 10;
real middle = (1.-1./cosh(tan(pi/(2*1.01))));
border C11(t=0,L/2.){x=t;y=.8*(1.-1./cosh(tan(pi*t/(L*1.01))));label=1;}
border C12(t=L/2.,L){x=t;y=.8*middle;label=1;}
border C2(t=0,1){x=L;y=.8*middle+t*(1-.8*middle);label=2;}
border C3(t=0,1){x=L*(1-t);y=1.;label=3;}
border C4(t=0,1){x=0;y=1-t;label=4;}

mesh Th = buildmesh(C11(50)+C12(50)+C2(2)+C3(100)+C4(10)); plot(Th,wait=mywait,aspectratio=0);

savemesh(Th,"../"+myname+"mesh1.msh"); plot(Th,wait=mywait,aspectratio=0);

for(int finesse=2; finesse<=4; finesse++)
{
//mesh Th = buildmesh(C11(2*L*finesse)+C12(2*L*finesse)+C2(4*finesse)+C3(4*L*finesse)+C4(20*finesse));

Th=trunc(Th,1,split=2);

// BEWARE: POINTS LABELS (AMONG ADJACENT EDGES) ARE THAT OF THE LAST CURVES
// BEWARE: ELEMENTS WITH 2 EDGES ON BOUNDARY FOR MIXED DIRICHLET-NEUMANN BC

//savemesh(Th,myname+"mesh"+finesse+".msh"); plot(Th,wait=mywait,aspectratio=0);
savemesh(Th,"../"+myname+"mesh"+finesse+".msh"); plot(Th,wait=mywait,aspectratio=0);
}


